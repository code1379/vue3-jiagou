{
  "version": 3,
  "sources": ["../../shared/src/index.ts", "../src/baseHandler.ts", "../src/reactive.ts", "../src/effect.ts"],
  "sourcesContent": ["export function isObject(value) {\n  return typeof value === \"object\" && value !== null;\n}\n\nexport function isFunction(value) {\n  return typeof value === \"function\";\n}\n", "export const enum ReactiveFlags {\n  \"IS_REACTIVE\" = \"__v_isReactive\",\n}\n// \u54CD\u5E94\u5F0F\u5BF9\u8C61\u5B9E\u73B0\u903B\u8F91\nexport const mutableHandler = {\n  // \u539F\u59CB\u5BF9\u8C61\uFF0C\u5C5E\u6027\uFF0C\u4EE3\u7406\u5BF9\u8C61\n  get(target, key, receiver) {\n    if (key === ReactiveFlags.IS_REACTIVE) {\n      return true;\n    }\n    console.log(\"\u53D6\u503C\u7684\u65F6\u5019\u5173\u8054 effect \");\n    return Reflect.get(target, key, receiver);\n  },\n  set(target, key, value, receiver) {\n    console.log(\"\u8BBE\u7F6E\u65B0\u7684\u503C\u65F6\uFF0C\u89E6\u53D1\u66F4\u65B0\");\n    return Reflect.set(target, key, value, receiver);\n  },\n};\n", "import { isObject } from \"@coco/shared\";\nimport { ReactiveFlags, mutableHandler } from \"./baseHandler\";\n\nexport function reactive(target) {\n  return createReactiveObject(target);\n}\n\nconst reactiveMap = new WeakMap(); // \u9632\u6B62\u5185\u5B58\u6CC4\u6F0F\nfunction createReactiveObject(target) {\n  // \u4E0D\u662F\u5BF9\u8C61\u76F4\u63A5\u8FD4\u56DE\n  if (!isObject(target)) return;\n\n  // \u589E\u6DFB\u81EA\u5B9A\u4E49\u5C5E\u6027\n  if (target[ReactiveFlags.IS_REACTIVE]) return target;\n\n  // \u7F13\u5B58\u7ED3\u679C\n  // \u9632\u6B62\u540C\u4E00\u4E2A\u5BF9\u8C61\u88AB\u4EE3\u7406\u591A\u6B21\uFF0C\u8FD4\u56DE\u7684\u6C38\u8FDC\u662F\u540C\u4E00\u4E2A\u4EE3\u7406\u5BF9\u8C61\n  let existingProxy = reactiveMap.get(target);\n  if (existingProxy) return existingProxy;\n\n  const proxy = new Proxy(target, mutableHandler);\n  reactiveMap.set(target, proxy);\n  return proxy;\n}\n", "export let activeEffect = undefined;\nclass ReactiveEffect {\n  parent: ReactiveEffect | undefined = undefined;\n  constructor(public fn) {}\n  run() {\n    // \u5F53\u8FD0\u884C\u7684\u65F6\u5019\uFF0C\u6211\u4EEC\u9700\u8981\u5C06\u5C5E\u6027\u548C\u5BF9\u5E94\u7684 effect \u5173\u8054\u8D77\u6765\n    // \u5229\u7528 js \u5355\u7EBF\u7A0B\u7684\u7279\u6027\uFF0C\u5148\u653E\u5728\u5168\u5C40\uFF0C\u518D\u53D6\u503C\n    try {\n      this.parent = activeEffect;\n      activeEffect = this;\n      return this.fn(); // \u4F1A\u89E6\u53D1\u5C5E\u6027\u7684 get\n    } finally {\n      // effect(() => {}); state.xxx = \"a\"; effect \u6267\u884C\u5B8C\u6BD5\u4E4B\u540E\uFF0C\u540E\u9762\u7684\u4EE3\u7801\u4E0D\u9700\u8981\u8FDB\u884C\u4F9D\u8D56\u6536\u96C6\n      activeEffect = this.parent;\n    }\n  }\n}\nexport function effect(fn) {\n  // \u5C06\u7528\u6237\u4F20\u9012\u7684\u51FD\u6570\uFF0C\u53D8\u6210\u54CD\u5E94\u5F0F\u7684\u51FD\u6570\n  const _effect = new ReactiveEffect(fn);\n  // \u9ED8\u8BA4\u8BA9\u7528\u6237\u7684\u51FD\u6570\u6267\u884C\u4E00\u6B21\n  _effect.run();\n}\n"],
  "mappings": ";AAAO,SAAS,SAAS,OAAO;AAC9B,SAAO,OAAO,UAAU,YAAY,UAAU;AAChD;;;ACEO,IAAM,iBAAiB;AAAA;AAAA,EAE5B,IAAI,QAAQ,KAAK,UAAU;AACzB,QAAI,QAAQ,oCAA2B;AACrC,aAAO;AAAA,IACT;AACA,YAAQ,IAAI,oDAAiB;AAC7B,WAAO,QAAQ,IAAI,QAAQ,KAAK,QAAQ;AAAA,EAC1C;AAAA,EACA,IAAI,QAAQ,KAAK,OAAO,UAAU;AAChC,YAAQ,IAAI,oEAAa;AACzB,WAAO,QAAQ,IAAI,QAAQ,KAAK,OAAO,QAAQ;AAAA,EACjD;AACF;;;ACdO,SAAS,SAAS,QAAQ;AAC/B,SAAO,qBAAqB,MAAM;AACpC;AAEA,IAAM,cAAc,oBAAI,QAAQ;AAChC,SAAS,qBAAqB,QAAQ;AAEpC,MAAI,CAAC,SAAS,MAAM;AAAG;AAGvB,MAAI,yCAAgC;AAAG,WAAO;AAI9C,MAAI,gBAAgB,YAAY,IAAI,MAAM;AAC1C,MAAI;AAAe,WAAO;AAE1B,QAAM,QAAQ,IAAI,MAAM,QAAQ,cAAc;AAC9C,cAAY,IAAI,QAAQ,KAAK;AAC7B,SAAO;AACT;;;ACvBO,IAAI,eAAe;AAC1B,IAAM,iBAAN,MAAqB;AAAA,EAEnB,YAAmB,IAAI;AAAJ;AADnB,kBAAqC;AAAA,EACb;AAAA,EACxB,MAAM;AAGJ,QAAI;AACF,WAAK,SAAS;AACd,qBAAe;AACf,aAAO,KAAK,GAAG;AAAA,IACjB,UAAE;AAEA,qBAAe,KAAK;AAAA,IACtB;AAAA,EACF;AACF;AACO,SAAS,OAAO,IAAI;AAEzB,QAAM,UAAU,IAAI,eAAe,EAAE;AAErC,UAAQ,IAAI;AACd;",
  "names": []
}
